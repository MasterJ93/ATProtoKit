{"kind":"article","hierarchy":{"paths":[["doc:\/\/ATProtoKit\/documentation\/ATProtoKit"]]},"metadata":{"role":"article","title":"Inspecting JSON with SessionDebuggable","roleHeading":"Article","modules":[{"name":"ATProtoKit"}]},"abstract":[{"text":"Learn how to inspect JSON objects in your requests and responses.","type":"text"}],"seeAlsoSections":[{"generated":true,"title":"Utilities","identifiers":["doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ATProtoTools","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/DateFormatting-PropertyWrapper","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ATFacetParser","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ConsoleDebugger","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/Truncatable","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/APIHostname"]}],"sections":[],"primaryContentSections":[{"kind":"content","content":[{"text":"Overview","type":"heading","anchor":"Overview","level":2},{"type":"paragraph","inlineContent":[{"text":"When building apps that communicate over HTTP, bugs often arise when the JSON sent or received doesn’t match what your code expects. Debugging these issues is much easier when you can inspect the ","type":"text"},{"type":"emphasis","inlineContent":[{"type":"text","text":"actual"}]},{"type":"text","text":" request and response payloads, headers, and endpoints."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"For this reason, ATProtoKit introduces a flexible debugging protocol: "},{"isActive":true,"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable","type":"reference"},{"text":".","type":"text"}]},{"type":"paragraph","inlineContent":[{"code":"SessionDebuggable","type":"codeVoice"},{"type":"text","text":" is a simple protocol that lets you inspect every outgoing request and incoming response—including JSON payloads, headers, and URLs. By plugging in your own implementation, you control "},{"type":"emphasis","inlineContent":[{"type":"text","text":"how"}]},{"type":"text","text":" and "},{"type":"emphasis","inlineContent":[{"type":"text","text":"where"}]},{"text":" this information is displayed or captured.","type":"text"}]},{"inlineContent":[{"type":"text","text":"Here’s the protocol definition:"}],"type":"paragraph"},{"code":["public protocol SessionDebuggable: Sendable {","    \/\/ Called before a request is sent.","    func logRequest(_ request: URLRequest, body: Data?)","","    \/\/ Called after a response is received.","    func logResponse(_ response: URLResponse?, data: Data?, error: Error?)","}"],"syntax":"swift","type":"codeListing"},{"items":[{"content":[{"inlineContent":[{"isActive":true,"type":"reference","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable\/logRequest(_:body:)"},{"type":"text","text":" displays information about the outgoing request."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"isActive":true,"type":"reference","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable\/logResponse(_:data:error:)"},{"type":"text","text":" displays details about the received response, including errors (if any)."}]}]}],"type":"unorderedList"},{"level":2,"text":"Using the Built-in ConsoleDebugger","type":"heading","anchor":"Using-the-Built-in-ConsoleDebugger"},{"inlineContent":[{"type":"text","text":"ATProtoKit provides a default implementation called "},{"isActive":true,"type":"reference","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ConsoleDebugger"},{"type":"text","text":". It prints request and response details to the console, including:"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Request URL and method;"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Headers;"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"JSON body (if present); and"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Response status code, headers, and body."}]}]}],"type":"unorderedList"},{"inlineContent":[{"type":"text","text":"To enable it, add this line before making network requests:"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["let apiClientConfiguration = APIClientConfiguration(logger: ConsoleDebugger())","let atProtoKit = ATProtoKit(","    sessionConfiguration: config,","    apiClientConfiguration: apiClientConfiguration",")"]},{"type":"aside","style":"tip","content":[{"inlineContent":[{"type":"text","text":"If you do nothing, debugging is disabled by default ("},{"code":"nil","type":"codeVoice"},{"type":"text","text":"), so there’s no runtime overhead in production."}],"type":"paragraph"}],"name":"Tip"},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"All debugging via "},{"type":"codeVoice","code":"SessionDebuggable"},{"type":"text","text":" and "},{"code":"ConsoleDebugger","type":"codeVoice"},{"type":"text","text":" runs only in debug mode."}]}],"type":"aside","name":"Note","style":"note"},{"text":"Implementing Your Own Debugger","level":2,"anchor":"Implementing-Your-Own-Debugger","type":"heading"},{"inlineContent":[{"type":"text","text":"You aren’t limited to printing to the console. You can log to a file, upload logs for analysis, or even display them in your app’s debug UI. Just conform to the "},{"type":"codeVoice","code":"SessionDebuggable"},{"text":" protocol:","type":"text"}],"type":"paragraph"},{"code":["public struct FileDebugger: SessionDebuggable {","    public func logRequest(_ request: URLRequest, body: Data?) {","        \/\/ Write request details to a file...","    }","","    public func logResponse(_ response: URLResponse?, data: Data?, error: Error?) {","        \/\/ Write response details to a file...","    }","}"],"syntax":"swift","type":"codeListing"},{"type":"paragraph","inlineContent":[{"text":"Then, enable your custom debugger:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["let apiClientConfiguration = APIClientConfiguration(logger: FileDebugger())","let atProtoKit = ATProtoKit(","    sessionConfiguration: config,","    apiClientConfiguration: apiClientConfiguration",")"]}]}],"variants":[{"paths":["\/documentation\/atprotokit\/sessiondebuggablearticle"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggableArticle"},"schemaVersion":{"patch":0,"minor":3,"major":0},"references":{"doc://ATProtoKit/documentation/ATProtoKit/Truncatable":{"kind":"symbol","role":"symbol","navigatorTitle":[{"text":"Truncatable","kind":"identifier"}],"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/Truncatable","abstract":[{"type":"text","text":"A protocol that defines a method for truncating an object."}],"fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"text":"Truncatable","kind":"identifier"}],"type":"topic","title":"Truncatable","url":"\/documentation\/atprotokit\/truncatable"},"atprotokit_icon.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/atprotokit_icon.png"}],"identifier":"atprotokit_icon.png","type":"image","alt":"A technology icon representing the ATProtoKit framework."},"doc://ATProtoKit/documentation/ATProtoKit/SessionDebuggable/logRequest(_:body:)":{"title":"logRequest(_:body:)","kind":"symbol","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"logRequest","kind":"identifier"},{"text":"(","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:10Foundation10URLRequestV","text":"URLRequest"},{"text":", ","kind":"text"},{"text":"body","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"Data","kind":"typeIdentifier","preciseIdentifier":"s:10Foundation4DataV"},{"text":"?)","kind":"text"}],"type":"topic","role":"symbol","abstract":[{"text":"Creates a log immediately before an HTTP request is sent.","type":"text"}],"required":true,"url":"\/documentation\/atprotokit\/sessiondebuggable\/logrequest(_:body:)","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable\/logRequest(_:body:)"},"doc://ATProtoKit/documentation/ATProtoKit/ATFacetParser":{"kind":"symbol","abstract":[{"type":"text","text":"A utility class designed for parsing various elements like mentions, URLs, and hashtags from text."}],"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ATFacetParser","title":"ATFacetParser","navigatorTitle":[{"text":"ATFacetParser","kind":"identifier"}],"role":"symbol","fragments":[{"kind":"keyword","text":"class"},{"text":" ","kind":"text"},{"text":"ATFacetParser","kind":"identifier"}],"type":"topic","url":"\/documentation\/atprotokit\/atfacetparser"},"doc://ATProtoKit/documentation/ATProtoKit/ATProtoTools":{"title":"ATProtoTools","abstract":[{"type":"text","text":"A group of methods for miscellaneous aspects of ATProtoKit."}],"navigatorTitle":[{"kind":"identifier","text":"ATProtoTools"}],"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ATProtoTools","url":"\/documentation\/atprotokit\/atprototools","role":"symbol","type":"topic","kind":"symbol","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"ATProtoTools","kind":"identifier"}]},"doc://ATProtoKit/documentation/ATProtoKit/SessionDebuggable":{"url":"\/documentation\/atprotokit\/sessiondebuggable","role":"symbol","title":"SessionDebuggable","type":"topic","navigatorTitle":[{"text":"SessionDebuggable","kind":"identifier"}],"abstract":[{"text":"A protocol for debugging and inspecting HTTP requests and responses within a network session.","type":"text"}],"fragments":[{"text":"protocol","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"SessionDebuggable"}],"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable","kind":"symbol"},"doc://ATProtoKit/documentation/ATProtoKit/SessionDebuggable/logResponse(_:data:error:)":{"kind":"symbol","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable\/logResponse(_:data:error:)","required":true,"role":"symbol","url":"\/documentation\/atprotokit\/sessiondebuggable\/logresponse(_:data:error:)","abstract":[{"type":"text","text":"Creates a log immediately after a response is received (or a request fails)."}],"fragments":[{"kind":"keyword","text":"func"},{"text":" ","kind":"text"},{"text":"logResponse","kind":"identifier"},{"text":"(","kind":"text"},{"text":"URLResponse","kind":"typeIdentifier","preciseIdentifier":"c:objc(cs)NSURLResponse"},{"text":"?, ","kind":"text"},{"kind":"externalParam","text":"data"},{"kind":"text","text":": "},{"text":"Data","kind":"typeIdentifier","preciseIdentifier":"s:10Foundation4DataV"},{"kind":"text","text":"?, "},{"text":"error","kind":"externalParam"},{"kind":"text","text":": (any "},{"preciseIdentifier":"s:s5ErrorP","kind":"typeIdentifier","text":"Error"},{"kind":"text","text":")?)"}],"type":"topic","title":"logResponse(_:data:error:)"},"doc://ATProtoKit/documentation/ATProtoKit/ConsoleDebugger":{"url":"\/documentation\/atprotokit\/consoledebugger","role":"symbol","title":"ConsoleDebugger","type":"topic","navigatorTitle":[{"text":"ConsoleDebugger","kind":"identifier"}],"abstract":[{"text":"A default implementation of the ","type":"text"},{"code":"SessionDebuggable","type":"codeVoice"},{"type":"text","text":" protocol that logs requests and responses to"},{"text":" ","type":"text"},{"type":"text","text":"the console."}],"fragments":[{"kind":"keyword","text":"struct"},{"text":" ","kind":"text"},{"text":"ConsoleDebugger","kind":"identifier"}],"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ConsoleDebugger","kind":"symbol"},"doc://ATProtoKit/documentation/ATProtoKit/DateFormatting-PropertyWrapper":{"url":"\/documentation\/atprotokit\/dateformatting-propertywrapper","kind":"article","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/DateFormatting-PropertyWrapper","title":"Custom Date Encoding and Decoding","role":"collectionGroup","abstract":[{"text":"Convert dates to and from the ISO8601 format.","type":"text"}],"type":"topic"},"doc://ATProtoKit/documentation/ATProtoKit":{"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit","images":[{"type":"icon","identifier":"atprotokit_icon.png"}],"abstract":[{"type":"text","text":"Develop and manage client and server-side applications for the AT Protocol and Bluesky."}],"url":"\/documentation\/atprotokit","kind":"symbol","type":"topic","role":"collection","title":"ATProtoKit"},"doc://ATProtoKit/documentation/ATProtoKit/APIHostname":{"title":"APIHostname","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/APIHostname","role":"symbol","fragments":[{"kind":"keyword","text":"enum"},{"text":" ","kind":"text"},{"text":"APIHostname","kind":"identifier"}],"navigatorTitle":[{"kind":"identifier","text":"APIHostname"}],"kind":"symbol","type":"topic","abstract":[{"text":"A list of hostnames used for the AT Protocol.","type":"text"}],"url":"\/documentation\/atprotokit\/apihostname"}}}