{"abstract":[{"type":"text","text":"Learn how to inspect JSON objects in your requests and responses."}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/atprotokit\/sessiondebuggablearticle"]}],"metadata":{"modules":[{"name":"ATProtoKit"}],"roleHeading":"Article","title":"Inspecting JSON with SessionDebuggable","role":"article"},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggableArticle"},"sections":[],"schemaVersion":{"major":0,"minor":3,"patch":0},"seeAlsoSections":[{"title":"Utilities","identifiers":["doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ATProtoTools","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/DateFormatting-PropertyWrapper","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ATFacetParser","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ConsoleDebugger","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/Truncatable"],"generated":true}],"hierarchy":{"paths":[["doc:\/\/ATProtoKit\/documentation\/ATProtoKit"]]},"primaryContentSections":[{"content":[{"text":"Overview","anchor":"Overview","level":2,"type":"heading"},{"type":"paragraph","inlineContent":[{"text":"When building apps that communicate over HTTP, bugs often arise when the JSON sent or received doesn’t match what your code expects. Debugging these issues is much easier when you can inspect the ","type":"text"},{"type":"emphasis","inlineContent":[{"text":"actual","type":"text"}]},{"type":"text","text":" request and response payloads, headers, and endpoints."}]},{"inlineContent":[{"type":"text","text":"For this reason, ATProtoKit introduces a flexible debugging protocol: "},{"type":"reference","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable","isActive":true},{"type":"text","text":"."}],"type":"paragraph"},{"inlineContent":[{"code":"SessionDebuggable","type":"codeVoice"},{"text":" is a simple protocol that lets you inspect every outgoing request and incoming response—including JSON payloads, headers, and URLs. By plugging in your own implementation, you control ","type":"text"},{"type":"emphasis","inlineContent":[{"type":"text","text":"how"}]},{"type":"text","text":" and "},{"type":"emphasis","inlineContent":[{"text":"where","type":"text"}]},{"type":"text","text":" this information is displayed or captured."}],"type":"paragraph"},{"inlineContent":[{"text":"Here’s the protocol definition:","type":"text"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["public protocol SessionDebuggable: Sendable {","    \/\/ Called before a request is sent.","    func logRequest(_ request: URLRequest, body: Data?)","","    \/\/ Called after a response is received.","    func logResponse(_ response: URLResponse?, data: Data?, error: Error?)","}"]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable\/logRequest(_:body:)","isActive":true,"type":"reference"},{"type":"text","text":" displays information about the outgoing request."}]}]},{"content":[{"inlineContent":[{"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable\/logResponse(_:data:error:)","type":"reference","isActive":true},{"type":"text","text":" displays details about the received response, including errors (if any)."}],"type":"paragraph"}]}],"type":"unorderedList"},{"anchor":"Using-the-Built-in-ConsoleDebugger","text":"Using the Built-in ConsoleDebugger","level":2,"type":"heading"},{"inlineContent":[{"text":"ATProtoKit provides a default implementation called ","type":"text"},{"type":"reference","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ConsoleDebugger","isActive":true},{"text":". It prints request and response details to the console, including:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Request URL and method;"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Headers;"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"JSON body (if present); and"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Response status code, headers, and body."}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"To enable it, add this line before making network requests:"}]},{"syntax":"swift","code":["await APIClientService.shared.setLogger(ConsoleDebugger())"],"type":"codeListing"},{"type":"aside","style":"tip","name":"Tip","content":[{"inlineContent":[{"text":"If you do nothing, debugging is disabled by default (","type":"text"},{"code":"nil","type":"codeVoice"},{"text":"), so there’s no runtime overhead in production.","type":"text"}],"type":"paragraph"}]},{"type":"aside","name":"Note","style":"note","content":[{"inlineContent":[{"type":"text","text":"All debugging via "},{"type":"codeVoice","code":"SessionDebuggable"},{"text":" and ","type":"text"},{"type":"codeVoice","code":"ConsoleDebugger"},{"text":" runs only in debug mode.","type":"text"}],"type":"paragraph"}]},{"anchor":"Implementing-Your-Own-Debugger","text":"Implementing Your Own Debugger","type":"heading","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"You aren’t limited to printing to the console. You can log to a file, upload logs for analysis, or even display them in your app’s debug UI. Just conform to the "},{"code":"SessionDebuggable","type":"codeVoice"},{"type":"text","text":" protocol:"}]},{"type":"codeListing","syntax":"swift","code":["public struct FileDebugger: SessionDebuggable {","    public func logRequest(_ request: URLRequest, body: Data?) {","        \/\/ Write request details to a file...","    }","","    public func logResponse(_ response: URLResponse?, data: Data?, error: Error?) {","        \/\/ Write response details to a file...","    }","}"]},{"inlineContent":[{"text":"Then, enable your custom debugger:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["await APIClientService.shared.setLogger(FileDebugger())"],"type":"codeListing"}],"kind":"content"}],"kind":"article","references":{"doc://ATProtoKit/documentation/ATProtoKit/SessionDebuggable":{"type":"topic","navigatorTitle":[{"text":"SessionDebuggable","kind":"identifier"}],"role":"symbol","fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"SessionDebuggable","kind":"identifier"}],"abstract":[{"type":"text","text":"A protocol for debugging and inspecting HTTP requests and responses within a network session."}],"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable","kind":"symbol","url":"\/documentation\/atprotokit\/sessiondebuggable","title":"SessionDebuggable"},"doc://ATProtoKit/documentation/ATProtoKit/ATFacetParser":{"navigatorTitle":[{"text":"ATFacetParser","kind":"identifier"}],"fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"ATFacetParser","kind":"identifier"}],"title":"ATFacetParser","abstract":[{"type":"text","text":"A utility class designed for parsing various elements like mentions, URLs, and hashtags from text."}],"role":"symbol","url":"\/documentation\/atprotokit\/atfacetparser","kind":"symbol","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ATFacetParser","type":"topic"},"doc://ATProtoKit/documentation/ATProtoKit/ConsoleDebugger":{"abstract":[{"text":"A default implementation of the ","type":"text"},{"type":"codeVoice","code":"SessionDebuggable"},{"type":"text","text":" protocol that logs requests and responses to"},{"text":" ","type":"text"},{"type":"text","text":"the console."}],"fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"ConsoleDebugger","kind":"identifier"}],"title":"ConsoleDebugger","kind":"symbol","navigatorTitle":[{"kind":"identifier","text":"ConsoleDebugger"}],"type":"topic","url":"\/documentation\/atprotokit\/consoledebugger","role":"symbol","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ConsoleDebugger"},"doc://ATProtoKit/documentation/ATProtoKit":{"type":"topic","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit","abstract":[{"text":"Develop and manage client and server-side applications for the AT Protocol and Bluesky.","type":"text"}],"role":"collection","title":"ATProtoKit","kind":"symbol","url":"\/documentation\/atprotokit","images":[{"type":"icon","identifier":"atprotokit_icon.png"}]},"atprotokit_icon.png":{"type":"image","variants":[{"url":"\/images\/atprotokit_icon.png","traits":["1x","light"]}],"alt":"A technology icon representing the ATProtoKit framework.","identifier":"atprotokit_icon.png"},"doc://ATProtoKit/documentation/ATProtoKit/SessionDebuggable/logRequest(_:body:)":{"abstract":[{"text":"Creates a log immediately before an HTTP request is sent.","type":"text"}],"role":"symbol","required":true,"type":"topic","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable\/logRequest(_:body:)","fragments":[{"kind":"keyword","text":"func"},{"text":" ","kind":"text"},{"text":"logRequest","kind":"identifier"},{"kind":"text","text":"("},{"text":"URLRequest","kind":"typeIdentifier","preciseIdentifier":"s:10Foundation10URLRequestV"},{"text":", ","kind":"text"},{"text":"body","kind":"externalParam"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:10Foundation4DataV","kind":"typeIdentifier","text":"Data"},{"text":"?)","kind":"text"}],"title":"logRequest(_:body:)","url":"\/documentation\/atprotokit\/sessiondebuggable\/logrequest(_:body:)","kind":"symbol"},"doc://ATProtoKit/documentation/ATProtoKit/Truncatable":{"navigatorTitle":[{"text":"Truncatable","kind":"identifier"}],"abstract":[{"type":"text","text":"A protocol that defines a method for truncating an object."}],"url":"\/documentation\/atprotokit\/truncatable","title":"Truncatable","role":"symbol","type":"topic","kind":"symbol","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"Truncatable"}],"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/Truncatable"},"doc://ATProtoKit/documentation/ATProtoKit/DateFormatting-PropertyWrapper":{"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/DateFormatting-PropertyWrapper","abstract":[{"text":"Convert dates to and from the ISO8601 format.","type":"text"}],"url":"\/documentation\/atprotokit\/dateformatting-propertywrapper","kind":"article","title":"Custom Date Encoding and Decoding","role":"collectionGroup","type":"topic"},"doc://ATProtoKit/documentation/ATProtoKit/ATProtoTools":{"url":"\/documentation\/atprotokit\/atprototools","type":"topic","title":"ATProtoTools","fragments":[{"kind":"keyword","text":"class"},{"text":" ","kind":"text"},{"kind":"identifier","text":"ATProtoTools"}],"abstract":[{"text":"A group of methods for miscellaneous aspects of ATProtoKit.","type":"text"}],"kind":"symbol","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ATProtoTools","navigatorTitle":[{"text":"ATProtoTools","kind":"identifier"}],"role":"symbol"},"doc://ATProtoKit/documentation/ATProtoKit/SessionDebuggable/logResponse(_:data:error:)":{"type":"topic","required":true,"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable\/logResponse(_:data:error:)","abstract":[{"type":"text","text":"Creates a log immediately after a response is received (or a request fails)."}],"url":"\/documentation\/atprotokit\/sessiondebuggable\/logresponse(_:data:error:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"logResponse"},{"kind":"text","text":"("},{"text":"URLResponse","preciseIdentifier":"c:objc(cs)NSURLResponse","kind":"typeIdentifier"},{"kind":"text","text":"?, "},{"text":"data","kind":"externalParam"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:10Foundation4DataV","text":"Data"},{"text":"?, ","kind":"text"},{"kind":"externalParam","text":"error"},{"text":": (any ","kind":"text"},{"text":"Error","kind":"typeIdentifier","preciseIdentifier":"s:s5ErrorP"},{"text":")?)","kind":"text"}],"title":"logResponse(_:data:error:)","kind":"symbol","role":"symbol"}}}