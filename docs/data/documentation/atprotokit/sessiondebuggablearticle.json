{"identifier":{"url":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggableArticle","interfaceLanguage":"swift"},"kind":"article","sections":[],"hierarchy":{"paths":[["doc:\/\/ATProtoKit\/documentation\/ATProtoKit"]]},"seeAlsoSections":[{"identifiers":["doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ATProtoTools","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/DateFormatting-PropertyWrapper","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ATFacetParser","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ConsoleDebugger","doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/Truncatable"],"title":"Utilities","generated":true}],"primaryContentSections":[{"kind":"content","content":[{"text":"Overview","type":"heading","level":2,"anchor":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"When building apps that communicate over HTTP, bugs often arise when the JSON sent or received doesn’t match what your code expects. Debugging these issues is much easier when you can inspect the "},{"type":"emphasis","inlineContent":[{"type":"text","text":"actual"}]},{"text":" request and response payloads, headers, and endpoints.","type":"text"}]},{"inlineContent":[{"type":"text","text":"For this reason, ATProtoKit introduces a flexible debugging protocol: "},{"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable","isActive":true,"type":"reference"},{"text":".","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"SessionDebuggable"},{"text":" is a simple protocol that lets you inspect every outgoing request and incoming response—including JSON payloads, headers, and URLs. By plugging in your own implementation, you control ","type":"text"},{"inlineContent":[{"type":"text","text":"how"}],"type":"emphasis"},{"text":" and ","type":"text"},{"type":"emphasis","inlineContent":[{"text":"where","type":"text"}]},{"type":"text","text":" this information is displayed or captured."}]},{"inlineContent":[{"text":"Here’s the protocol definition:","type":"text"}],"type":"paragraph"},{"code":["public protocol SessionDebuggable: Sendable {","    \/\/ Called before a request is sent.","    func logRequest(_ request: URLRequest, body: Data?)","","    \/\/ Called after a response is received.","    func logResponse(_ response: URLResponse?, data: Data?, error: Error?)","}"],"syntax":"swift","type":"codeListing"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","isActive":true,"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable\/logRequest(_:body:)"},{"type":"text","text":" displays information about the outgoing request."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable\/logResponse(_:data:error:)","isActive":true,"type":"reference"},{"type":"text","text":" displays details about the received response, including errors (if any)."}]}]}]},{"text":"Using the Built-in ConsoleDebugger","anchor":"Using-the-Built-in-ConsoleDebugger","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"ATProtoKit provides a default implementation called "},{"type":"reference","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ConsoleDebugger","isActive":true},{"type":"text","text":". It prints request and response details to the console, including:"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Request URL and method;","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Headers;"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"JSON body (if present); and","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Response status code, headers, and body."}]}]}],"type":"unorderedList"},{"inlineContent":[{"type":"text","text":"To enable it, add this line before making network requests:"}],"type":"paragraph"},{"syntax":"swift","code":["await APIClientService.shared.setLogger(ConsoleDebugger())"],"type":"codeListing"},{"name":"Tip","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"If you do nothing, debugging is disabled by default ("},{"type":"codeVoice","code":"nil"},{"text":"), so there’s no runtime overhead in production.","type":"text"}]}],"style":"tip","type":"aside"},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"All debugging via "},{"type":"codeVoice","code":"SessionDebuggable"},{"type":"text","text":" and "},{"type":"codeVoice","code":"ConsoleDebugger"},{"text":" runs only in debug mode.","type":"text"}]}],"type":"aside","name":"Note","style":"note"},{"type":"heading","anchor":"Implementing-Your-Own-Debugger","text":"Implementing Your Own Debugger","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"You aren’t limited to printing to the console. You can log to a file, upload logs for analysis, or even display them in your app’s debug UI. Just conform to the "},{"code":"SessionDebuggable","type":"codeVoice"},{"text":" protocol:","type":"text"}]},{"type":"codeListing","code":["public struct FileDebugger: SessionDebuggable {","    public func logRequest(_ request: URLRequest, body: Data?) {","        \/\/ Write request details to a file...","    }","","    public func logResponse(_ response: URLResponse?, data: Data?, error: Error?) {","        \/\/ Write response details to a file...","    }","}"],"syntax":"swift"},{"inlineContent":[{"type":"text","text":"Then, enable your custom debugger:"}],"type":"paragraph"},{"code":["await APIClientService.shared.setLogger(FileDebugger())"],"type":"codeListing","syntax":"swift"}]}],"schemaVersion":{"major":0,"patch":0,"minor":3},"abstract":[{"type":"text","text":"Learn how to inspect JSON objects in your requests and responses."}],"variants":[{"paths":["\/documentation\/atprotokit\/sessiondebuggablearticle"],"traits":[{"interfaceLanguage":"swift"}]}],"metadata":{"roleHeading":"Article","title":"Inspecting JSON with SessionDebuggable","role":"article","modules":[{"name":"ATProtoKit"}]},"references":{"doc://ATProtoKit/documentation/ATProtoKit/DateFormatting-PropertyWrapper":{"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/DateFormatting-PropertyWrapper","title":"Custom Date Encoding and Decoding","url":"\/documentation\/atprotokit\/dateformatting-propertywrapper","abstract":[{"text":"Convert dates to and from the ISO8601 format.","type":"text"}],"type":"topic","kind":"article","role":"collectionGroup"},"doc://ATProtoKit/documentation/ATProtoKit":{"abstract":[{"type":"text","text":"Develop and manage client and server-side applications for the AT Protocol and Bluesky."}],"type":"topic","title":"ATProtoKit","url":"\/documentation\/atprotokit","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit","role":"collection","images":[{"type":"icon","identifier":"atprotokit_icon.png"}],"kind":"symbol"},"atprotokit_icon.png":{"alt":"A technology icon representing the ATProtoKit framework.","type":"image","identifier":"atprotokit_icon.png","variants":[{"traits":["1x","light"],"url":"\/images\/atprotokit_icon.png"}]},"doc://ATProtoKit/documentation/ATProtoKit/SessionDebuggable":{"navigatorTitle":[{"kind":"identifier","text":"SessionDebuggable"}],"url":"\/documentation\/atprotokit\/sessiondebuggable","title":"SessionDebuggable","fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"SessionDebuggable","kind":"identifier"}],"kind":"symbol","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable","type":"topic","abstract":[{"text":"A protocol for debugging and inspecting HTTP requests and responses within a network session.","type":"text"}],"role":"symbol"},"doc://ATProtoKit/documentation/ATProtoKit/Truncatable":{"navigatorTitle":[{"text":"Truncatable","kind":"identifier"}],"url":"\/documentation\/atprotokit\/truncatable","title":"Truncatable","fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"Truncatable"}],"kind":"symbol","type":"topic","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/Truncatable","abstract":[{"text":"A protocol that defines a method for truncating an object.","type":"text"}],"role":"symbol"},"doc://ATProtoKit/documentation/ATProtoKit/SessionDebuggable/logRequest(_:body:)":{"title":"logRequest(_:body:)","kind":"symbol","url":"\/documentation\/atprotokit\/sessiondebuggable\/logrequest(_:body:)","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable\/logRequest(_:body:)","abstract":[{"type":"text","text":"Creates a log immediately before an HTTP request is sent."}],"required":true,"role":"symbol","fragments":[{"kind":"keyword","text":"func"},{"text":" ","kind":"text"},{"text":"logRequest","kind":"identifier"},{"text":"(","kind":"text"},{"kind":"typeIdentifier","text":"URLRequest","preciseIdentifier":"s:10Foundation10URLRequestV"},{"text":", ","kind":"text"},{"text":"body","kind":"externalParam"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:10Foundation4DataV","text":"Data"},{"text":"?)","kind":"text"}],"type":"topic"},"doc://ATProtoKit/documentation/ATProtoKit/ConsoleDebugger":{"navigatorTitle":[{"kind":"identifier","text":"ConsoleDebugger"}],"url":"\/documentation\/atprotokit\/consoledebugger","title":"ConsoleDebugger","fragments":[{"text":"struct","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"ConsoleDebugger"}],"kind":"symbol","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ConsoleDebugger","type":"topic","abstract":[{"type":"text","text":"A default implementation of the "},{"type":"codeVoice","code":"SessionDebuggable"},{"type":"text","text":" protocol that logs requests and responses to"},{"text":" ","type":"text"},{"text":"the console.","type":"text"}],"role":"symbol"},"doc://ATProtoKit/documentation/ATProtoKit/ATProtoTools":{"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ATProtoTools","title":"ATProtoTools","url":"\/documentation\/atprotokit\/atprototools","abstract":[{"type":"text","text":"A group of methods for miscellaneous aspects of ATProtoKit."}],"type":"topic","kind":"symbol","role":"symbol","fragments":[{"text":"class","kind":"keyword"},{"kind":"text","text":" "},{"text":"ATProtoTools","kind":"identifier"}],"navigatorTitle":[{"text":"ATProtoTools","kind":"identifier"}]},"doc://ATProtoKit/documentation/ATProtoKit/SessionDebuggable/logResponse(_:data:error:)":{"role":"symbol","url":"\/documentation\/atprotokit\/sessiondebuggable\/logresponse(_:data:error:)","kind":"symbol","type":"topic","fragments":[{"kind":"keyword","text":"func"},{"text":" ","kind":"text"},{"kind":"identifier","text":"logResponse"},{"text":"(","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"c:objc(cs)NSURLResponse","text":"URLResponse"},{"text":"?, ","kind":"text"},{"kind":"externalParam","text":"data"},{"kind":"text","text":": "},{"text":"Data","kind":"typeIdentifier","preciseIdentifier":"s:10Foundation4DataV"},{"text":"?, ","kind":"text"},{"kind":"externalParam","text":"error"},{"kind":"text","text":": (any "},{"kind":"typeIdentifier","text":"Error","preciseIdentifier":"s:s5ErrorP"},{"text":")?)","kind":"text"}],"identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/SessionDebuggable\/logResponse(_:data:error:)","title":"logResponse(_:data:error:)","required":true,"abstract":[{"type":"text","text":"Creates a log immediately after a response is received (or a request fails)."}]},"doc://ATProtoKit/documentation/ATProtoKit/ATFacetParser":{"navigatorTitle":[{"kind":"identifier","text":"ATFacetParser"}],"kind":"symbol","role":"symbol","url":"\/documentation\/atprotokit\/atfacetparser","title":"ATFacetParser","identifier":"doc:\/\/ATProtoKit\/documentation\/ATProtoKit\/ATFacetParser","fragments":[{"text":"class","kind":"keyword"},{"kind":"text","text":" "},{"text":"ATFacetParser","kind":"identifier"}],"abstract":[{"text":"A utility class designed for parsing various elements like mentions, URLs, and hashtags from text.","type":"text"}],"type":"topic"}}}